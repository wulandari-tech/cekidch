<!DOCTYPE html>
<html>
<head>
    <title>Picsart Upscale</title>
    <style>
        #resultImage {
            max-width: 100%; /* Pastikan gambar tidak melebihi lebar container */
            height: auto; /* Biarkan tinggi menyesuaikan proporsi */
        }
    </style>
</head>
<body>
    <h1>Upscale Gambar dengan Picsart API</h1>

    <form id="uploadForm" enctype="multipart/form-data">
        <input type="file" name="image" id="imageInput" accept="image/*">
        <button type="submit">Upscale</button>
    </form>

    <div id="result">
        <h2>Hasil Upscale:</h2>
        <img id="resultImage" src="" alt="Upscaled Image">
        <p id="errorMessage" style="color: red;"></p>
    </div>

    <script>
        const uploadForm = document.getElementById('uploadForm');
        const imageInput = document.getElementById('imageInput');
        const resultImage = document.getElementById('resultImage');
        const errorMessage = document.getElementById('errorMessage');

        uploadForm.addEventListener('submit', async (event) => {
            event.preventDefault(); // Mencegah form submit default
            errorMessage.textContent = ''; // Reset pesan error
            resultImage.src = ''; // Reset gambar

            const formData = new FormData();
            formData.append('image', imageInput.files[0]);

            try {
                const response = await fetch('/upscale', {  // Perhatikan URL: /upscale
                    method: 'POST',
                    body: formData, // Kirim FormData (bukan JSON) karena ini file upload
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    errorMessage.textContent = errorData.error;
                    return;
                }

                const result = await response.json();

                // Tampilkan gambar yang di-upscale
                if (result.upscaled_image) {
                    resultImage.src = `data:image/jpeg;base64,${result.upscaled_image}`; // Asumsi hasil Base64
                } else {
                    errorMessage.textContent = 'Upscaled image not found in response.';
                }

            } catch (error) {
                console.error('Error:', error);
                errorMessage.textContent = 'An error occurred during the request.';
            }
        });
    </script>
</body>
</html>
